<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="dark-mode"></html>
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BusBricks: BusBricks</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="toggle-alternative-theme.js"></script>
<script type="text/javascript">
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
    DoxygenAwesomeTabs.init()
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="custom.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="header.html" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/F-L-X-S/BusBricks" class="github-corner" title="View source on GitHub" target="_blank" rel="noopener noreferrer">
    <svg viewBox="0 0 250 250" width="40" height="40" style="position: absolute; top: 0; border: 0; right: 0; z-index: 99;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.drawio.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BusBricks
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Customize bus-communication</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">BusBricks </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__2_users_2felixschulke_2_developement_2_arduino_2_modbus___r_t_u_2_modbus___r_t_u_2_modbus-_r_t_u_2_r_e_a_d_m_e"></a></p>
<p>OSI-oriented modularization to customize communication between Layer-7-services on interchangeable Layer-1/2-interfaces. <br  />
 The architecture is usable for all MCUs of the Arduino-platform. <br  />
 ðŸ“– <a href="https://f-l-x-s.github.io/BusBricks/">Checkout detailed Documentation</a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
Vision</h1>
<p>Provide configurable software-modules to customize the communication between services, hosted on different MCUs. <br  />
 BusBricks are templates to derive classes for mapping service-specific rules to different bus-systems. The communication between the hosting devices is therefore separated from the inter-service-communication. That means, the communication between the services can follow it's own (from the chosen communication-interface independent) rules. <br  />
</p>
<h2><a class="anchor" id="autotoc_md2"></a>
example use-case: Messenger-service</h2>
<p>Hosting a messenger on different host-devices. Some of those hosts support a serial commuication for modbus-RTU, some only support I2C.<br  />
 </p>
<h3><a class="anchor" id="autotoc_md3"></a>
Roadmap:</h3>
<h5><a class="anchor" id="autotoc_md4"></a>
Message-Service implementation</h5>
<ul class="check">
<li class="checked"><a href="lib/MessageService/Message.h">Message</a> content and payload definition</li>
</ul>
<ul class="check">
<li class="checked">Implementation of the <a href="lib/MessageService/MessageService.h">Messenger-Service</a></li>
</ul>
<h5><a class="anchor" id="autotoc_md5"></a>
Modbus-RTU implementation</h5>
<ul class="check">
<li class="checked">Implementation of the <a href="lib/ModbusRTU/CommInterface_modbusRTU.h">Modbus-RTU communication-interface</a></li>
</ul>
<ul class="check">
<li class="checked"><a href="lib/ModbusRTU/Frame_modbusRTU.h">Modbus-RTU frame</a> definition</li>
</ul>
<ul class="check">
<li class="checked">Implementation of the <a href="lib/ModbusRTU/ServiceInterface_modbusRTU.h">Modbus-RTU Service-interface</a></li>
</ul>
<ul class="check">
<li class="checked">Registration of <a href="lib/MessageService/MessageService.h">Messenger-Service</a>-instance and <a href="lib/ErrorService/ErrorService.h">Error-Service</a>-instance within an <a href="lib/Service/ServiceCluster.h">service-cluster</a> in <a href="src/main.cpp">main</a></li>
</ul>
<ul class="check">
<li class="checked">Implementation of <a href="lib/Interface/ServiceInterface.h">Modbus-RTU Service-Interface</a> to process payload from/for the registered services and frames of from/for <a href="lib/ModbusRTU/CommInterface_modbusRTU.h">Modbus-RTU communication-interface</a></li>
<li class="unchecked">Setup of the <a href="lib/ModbusRTU/ServiceInterface_modbusRTU.h">Modbus-RTU Service-interface</a> for Master-mode (polling and message-forwarding)</li>
</ul>
<ul class="check">
<li class="unchecked">Response-Timeout for Message-Service</li>
</ul>
<h5><a class="anchor" id="autotoc_md6"></a>
I2C implementation</h5>
<ul class="check">
<li class="unchecked">Implementation of a <a href="lib/Interface/CommInterface.h">communication-interface</a> derived I2C-communication-interface</li>
</ul>
<ul class="check">
<li class="unchecked">Definition of a <a href="lib/Frame/Frame.h">Frame</a> derived I2C-Frame-class</li>
</ul>
<ul class="check">
<li class="unchecked">Setup of an I2C service-interface</li>
</ul>
<ul class="check">
<li class="unchecked">Setup <a href="lib/Service/Service.h">service-template</a> and <a href="lib/Service/ServiceCluster.h">service-cluster</a> for association in multiple <a href="lib/Interface/ServiceInterface.h">service-interfaces</a></li>
</ul>
<h5><a class="anchor" id="autotoc_md7"></a>
User-interaction</h5>
<ul class="check">
<li class="checked">Setup of a tiny chat-interface in <a href="src/main.cpp">main</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md8"></a>
Basic Concepts</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
Service- and Communication-Layer</h2>
<p>The separation of inter-service- and inter-mcu-communication-rules requires a separation of the software modules. <br  />
<br  />
</p>
<h4><a class="anchor" id="autotoc_md10"></a>
Service-Layer</h4>
<p><b>Services</b> are defined in the <b>service-layer</b>. All implementations in the service-layer are Service-specific and therefore they should not depend on the chosen communication-interface. That means, the service-layer-modules should be <b>reusable, independent which communication-interface the host-device supports</b>.</p>
<h4><a class="anchor" id="autotoc_md11"></a>
Communication-Layer</h4>
<p>Modules being part of the Communication-Layer are specific for the chosen bus (e.g. I2C, OneWire, Musbus-rtu...) the host device provides. They are responsible for <b>applying the bus-protocol-specific rules (e.g. CRC-check and -calculation, communication-timeouts, framelength...) to the content (PDU)</b> provided by the services. <br  />
</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Content and representation</h2>
<p>The cascading of processing information and the rules applied to it lead to the concept of <em>content- and representation</em>.<br  />
 In every iteration, an information is processed and the rules of the next level, closer to the physical layer are applied to it, the information closer to the format the service is able to process is called <b><a class="el" href="class_content.html" title="The cascading of processing information and the rules applied to it lead to the concept of content- a...">Content</a></b>.<br  />
 Conversely, the format, the information has after applying the rules of the next level closer to "Layer-0" is called <b>representation</b>.<br  />
<br  />
 <img src="https://raw.githubusercontent.com/F-L-X-S/BusBricks/refs/heads/main/docs/Content_Representation.svg" alt="Content and Representation" style="pointer-events: none; width:100%;" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md13"></a>
Classdiagram</h2>
<p><img src="https://raw.githubusercontent.com/F-L-X-S/BusBricks/fa4a1927d184c56d71477509aa5243d7c93def95/docs/classdiagram.svg" alt="classdiagram" style="pointer-events: none; width:100%;" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md14"></a>
Protocoll-stack</h2>
<p><img src="https://raw.githubusercontent.com/F-L-X-S/BusBricks/refs/heads/main/docs/protocollstack.svg" alt="protocollstack" style="pointer-events: none; width:100%;" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md15"></a>
Stackprocessing</h2>
<p><img src="https://raw.githubusercontent.com/F-L-X-S/BusBricks/fa4a1927d184c56d71477509aa5243d7c93def95/docs/stackProcessing.svg" alt="stackProcessing" style="pointer-events: none; width:75%;" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md16"></a>
Error-handling</h2>
<p>The Errors of a device are managed by a Service-derived <a href="lib/ErrorService/ErrorService.h"><code>ErrorService</code></a>. Every component (no matter, if <a class="el" href="class_service.html" title="Service-Template to derive a Service class by defining the Content (derived Class of &quot;Content&quot;) to ha...">Service</a>, <a class="el" href="class_service_interface.html" title="Template for generic Service-Interface Defines the handling of incoming frames from CommInterface to ...">ServiceInterface</a> or <a class="el" href="class_comm_interface.html" title="Template for generic communication-interface specifies a standardized interface to use for integratin...">CommInterface</a>) can be enabled to raise errors by deriving the <a href="lib/ErrorService/ErrorState.h"><code>ErrorState</code></a> and calling <code>raiseError()</code>. <br  />
 </p><div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_class" href="class_comm_interface_base.html">CommInterfaceBase</a>: <span class="keyword">public</span> <a class="code hl_class" href="class_error_state.html">ErrorState</a>{</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        <a class="code hl_function" href="class_comm_interface_base.html#ac1c7e099dc4fce9e9c93a93cbf3c133e">CommInterfaceBase</a>(): <a class="code hl_class" href="class_error_state.html">ErrorState</a>(){};</div>
<div class="line">}</div>
<div class="ttc" id="aclass_comm_interface_base_html"><div class="ttname"><a href="class_comm_interface_base.html">CommInterfaceBase</a></div><div class="ttdoc">Communcation-Interface-Base-Class of the CommInterface template specifies a standardized interface to...</div><div class="ttdef"><b>Definition</b> CommInterface.h:54</div></div>
<div class="ttc" id="aclass_comm_interface_base_html_ac1c7e099dc4fce9e9c93a93cbf3c133e"><div class="ttname"><a href="class_comm_interface_base.html#ac1c7e099dc4fce9e9c93a93cbf3c133e">CommInterfaceBase::CommInterfaceBase</a></div><div class="ttdeci">CommInterfaceBase()</div><div class="ttdoc">Construct a new Comm Interface Base object.</div><div class="ttdef"><b>Definition</b> CommInterface.h:96</div></div>
<div class="ttc" id="aclass_error_state_html"><div class="ttname"><a href="class_error_state.html">ErrorState</a></div><div class="ttdoc">A class to manage and track error states using error codes.</div><div class="ttdef"><b>Definition</b> ErrorState.h:49</div></div>
</div><!-- fragment --><p> The class-instance is now able to raise Errors and, if applicable, to handle them within the class itself. E.g.:<br  />
 </p><div class="fragment"><div class="line"><span class="comment">// wait for Frame-timeout to ensure frame is complete, raise Error, if the silence-time is violated</span></div>
<div class="line"><span class="keywordflow">if</span>((_clearRxBuffer()&gt;0) &amp; (receiveBuffer-&gt;getSize()!=0)){</div>
<div class="line">  (numBytes&gt;=<a class="code hl_define" href="_comm_interface__modbus_r_t_u_8h.html#afaf81cfe1f7c01e8fa6c4b1a592b0f53">MAXFRAMESIZE</a>) ? raiseError(<a class="code hl_enumvalue" href="_error_8h.html#a88edd67ec29d18293fae821840fef3acaebbf7bd809b94b7d0725f163a4d406a9">frameLengthError</a>):raiseError(<a class="code hl_enumvalue" href="_error_8h.html#a88edd67ec29d18293fae821840fef3aca3d04e5ac1616b4f17188bf1cc86bdfd6">arbitrationError</a>);</div>
<div class="line">} </div>
<div class="line"> </div>
<div class="line"><span class="comment">// handle the Arbitration-Error with waiting for bus-silence</span></div>
<div class="line"><span class="keywordflow">if</span>(getErrorState()==<a class="code hl_enumvalue" href="_error_8h.html#a88edd67ec29d18293fae821840fef3aca3d04e5ac1616b4f17188bf1cc86bdfd6">arbitrationError</a>) <span class="keywordflow">while</span>(_clearRxBuffer()!=0);</div>
<div class="ttc" id="a_comm_interface__modbus_r_t_u_8h_html_afaf81cfe1f7c01e8fa6c4b1a592b0f53"><div class="ttname"><a href="_comm_interface__modbus_r_t_u_8h.html#afaf81cfe1f7c01e8fa6c4b1a592b0f53">MAXFRAMESIZE</a></div><div class="ttdeci">#define MAXFRAMESIZE</div><div class="ttdoc">debugging flag to print debugging-information on Serial</div><div class="ttdef"><b>Definition</b> CommInterface_modbusRTU.h:43</div></div>
<div class="ttc" id="a_error_8h_html_a88edd67ec29d18293fae821840fef3aca3d04e5ac1616b4f17188bf1cc86bdfd6"><div class="ttname"><a href="_error_8h.html#a88edd67ec29d18293fae821840fef3aca3d04e5ac1616b4f17188bf1cc86bdfd6">arbitrationError</a></div><div class="ttdeci">@ arbitrationError</div><div class="ttdoc">Violated silence-time between frames.</div><div class="ttdef"><b>Definition</b> Error.h:66</div></div>
<div class="ttc" id="a_error_8h_html_a88edd67ec29d18293fae821840fef3acaebbf7bd809b94b7d0725f163a4d406a9"><div class="ttname"><a href="_error_8h.html#a88edd67ec29d18293fae821840fef3acaebbf7bd809b94b7d0725f163a4d406a9">frameLengthError</a></div><div class="ttdeci">@ frameLengthError</div><div class="ttdoc">Maximum framelength violated.</div><div class="ttdef"><b>Definition</b> Error.h:78</div></div>
</div><!-- fragment --><p>To handle the <a class="el" href="class_error.html" title="Represents an error with it&#39;s error-content (error-code and an error-message), and provides methods f...">Error</a> outside the instance, the Error-state of the components has to be processed within the <a href="lib/Interface/ServiceInterface.h"><code>ServiceInterface</code></a> by checking the <a class="el" href="class_error_state.html" title="A class to manage and track error states using error codes.">ErrorState</a> of the called instances and, if applicable raising the <a class="el" href="class_error.html" title="Represents an error with it&#39;s error-content (error-code and an error-message), and provides methods f...">Error</a> with the same Error-code within the <a class="el" href="class_service_interface.html" title="Template for generic Service-Interface Defines the handling of incoming frames from CommInterface to ...">ServiceInterface</a>: <br  />
</p>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="_error_8h.html#a88edd67ec29d18293fae821840fef3ac">errorCodes</a> commInterfaceErrorState = comm_interface-&gt;getErrorState();</div>
<div class="line"><span class="keywordflow">if</span> (commInterfaceErrorState!=<a class="code hl_enumvalue" href="_error_8h.html#a88edd67ec29d18293fae821840fef3acab22416d928134d1c6c7b2e8d2c31f20b">noError</a>) raiseError(commInterfaceErrorState);</div>
<div class="ttc" id="a_error_8h_html_a88edd67ec29d18293fae821840fef3ac"><div class="ttname"><a href="_error_8h.html#a88edd67ec29d18293fae821840fef3ac">errorCodes</a></div><div class="ttdeci">errorCodes</div><div class="ttdoc">Enumeration for various error codes.</div><div class="ttdef"><b>Definition</b> Error.h:47</div></div>
<div class="ttc" id="a_error_8h_html_a88edd67ec29d18293fae821840fef3acab22416d928134d1c6c7b2e8d2c31f20b"><div class="ttname"><a href="_error_8h.html#a88edd67ec29d18293fae821840fef3acab22416d928134d1c6c7b2e8d2c31f20b">noError</a></div><div class="ttdeci">@ noError</div><div class="ttdoc">no Error</div><div class="ttdef"><b>Definition</b> Error.h:51</div></div>
</div><!-- fragment --><p>Only Errors raised in <a href="lib/Interface/ServiceInterface.h"><code>ServiceInterface</code></a> are forwarded to an eventually registered <a href="lib/ErrorService/ErrorService.h"><code>ErrorService</code></a>, that can execute error-code-specific actions (like printing the <a class="el" href="class_error.html" title="Represents an error with it&#39;s error-content (error-code and an error-message), and provides methods f...">Error</a> or broadcasting errors to the network). <br  />
 After handling the <a class="el" href="class_error.html" title="Represents an error with it&#39;s error-content (error-code and an error-message), and provides methods f...">Error</a> of the called instance, the <a class="el" href="class_error_state.html" title="A class to manage and track error states using error codes.">ErrorState</a> has to be cleared:<br  />
 </p><div class="fragment"><div class="line">comm_interface-&gt;clearErrorState();</div>
</div><!-- fragment --><p>The Error-codes are enumerated in the Content-derived <a href="lib/ErrorService/Error.h">Error-class</a>. To add new Error-cases, define a new Error-code in <code>enum ErrorCodes</code> and add an Error-message to the <code>getErrorMessage(errorCodes code)</code>function within the <a href="lib/ErrorService/Error.h">Error-class</a>. The Error-Service will display those messages after an <a class="el" href="class_error.html" title="Represents an error with it&#39;s error-content (error-code and an error-message), and provides methods f...">Error</a> is either raised by another component on the local device or an Error-Frame was received.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Deriving a custom Service</h1>
<p>To derive a Layer-7-service, that can be used in combination with the predefined Layer-2-communication-interfaces, you have to</p><ul class="check">
<li class="checked">define content to handle</li>
</ul>
<ul class="check">
<li class="checked">define a service to handle the specified content</li>
</ul>
<h2><a class="anchor" id="autotoc_md18"></a>
Define the content</h2>
<p>Each <a href="https://f-l-x-s.github.io/BusBricks/class_service.html">Service</a> has to know, how the conversion between the processable data structure (content) and the payload, that is sended or received by the communication-layer (representation) is defined. This is done by</p><ul class="check">
<li class="checked">deriving a content-class from the <a href="lib/Service/Content.h">content-template</a> (<a href="https://f-l-x-s.github.io/BusBricks/class_content.html">docs</a>) <br  />
</li>
</ul>
<p>The mapping between content and representation (in this case <code>String</code>) is defined by:<br  />
</p>
<ul class="check">
<li class="checked">overwriting and implementing the template functions <code>content_to_rep()</code> and <code>rep_to_content()</code> of <a href="https://f-l-x-s.github.io/BusBricks/class_content.html"><code>Content</code></a></li>
</ul>
<ul class="check">
<li class="checked">adding specific functions to be used inside of the service (optional) (e.g. <a href="https://f-l-x-s.github.io/BusBricks/class_message.html#a8907afa8cc86db8a3623aea0caba0324">string representation for printing</a> of the <a href="https://f-l-x-s.github.io/BusBricks/class_message.html">Message-Class</a>)</li>
</ul>
<h2><a class="anchor" id="autotoc_md19"></a>
Define the service</h2>
<p>A <a href="https://f-l-x-s.github.io/BusBricks/class_service.html">Service</a> is meant to process incoming payload and eventually generate new payload to be send. Received Payload is added to the <a class="el" href="class_service.html" title="Service-Template to derive a Service class by defining the Content (derived Class of &quot;Content&quot;) to ha...">Service</a> with <a href="https://f-l-x-s.github.io/BusBricks/class_service.html#ac0c60bc735c64547dee269c6c3a62767"><code>impart_pdu</code></a> and the services response is able to be picked up by calling <a href="https://f-l-x-s.github.io/BusBricks/class_service.html#a601e6d2878ce2b292a3b7c6428f0d51f"><code>get_response</code></a>. Both functions of the <a href="https://f-l-x-s.github.io/BusBricks/class_service.html">service-template</a> are using the representation (for services contents always String) of the <a class="el" href="class_content.html" title="The cascading of processing information and the rules applied to it lead to the concept of content- a...">Content</a>.<br  />
 Defining a custom service is done by</p><ul class="check">
<li class="checked">deriving a service-class from the <a href="lib/Service/Service.h">service-template</a></li>
</ul>
<ul class="check">
<li class="checked">defining a default Service-ID (unique for each service)</li>
</ul>
<ul class="check">
<li class="checked">define construction with Service-ID and Instance-ID (unique for each instantiation of a service), e.g.: <div class="fragment"><div class="line"><span class="preprocessor">#define SERVICEID &#39;e&#39;</span></div>
<div class="line"><a class="code hl_function" href="class_error_service.html#a77cf6af4e077a494655aca530d781185">ErrorService::ErrorService</a>(uint8_t instance_id): <a class="code hl_class" href="class_service.html">Service</a>&lt;<a class="code hl_class" href="class_error.html">Error</a>, <a class="code hl_define" href="_error_service_8h.html#a21d9543c516fffee84a7963224271f95">STACKSIZE</a>&gt;(<a class="code hl_define" href="_error_service_8h.html#aaabf701155256a538027633a5d275632">SERVICEID</a>, instance_id){}</div>
<div class="ttc" id="a_error_service_8h_html_a21d9543c516fffee84a7963224271f95"><div class="ttname"><a href="_error_service_8h.html#a21d9543c516fffee84a7963224271f95">STACKSIZE</a></div><div class="ttdeci">#define STACKSIZE</div><div class="ttdoc">Number of elements the services stacks can store.</div><div class="ttdef"><b>Definition</b> ErrorService.h:38</div></div>
<div class="ttc" id="a_error_service_8h_html_aaabf701155256a538027633a5d275632"><div class="ttname"><a href="_error_service_8h.html#aaabf701155256a538027633a5d275632">SERVICEID</a></div><div class="ttdeci">#define SERVICEID</div><div class="ttdoc">Service-id ASCII: &quot;e&quot;.</div><div class="ttdef"><b>Definition</b> ErrorService.h:41</div></div>
<div class="ttc" id="aclass_error_html"><div class="ttname"><a href="class_error.html">Error</a></div><div class="ttdoc">Represents an error with it's error-content (error-code and an error-message), and provides methods f...</div><div class="ttdef"><b>Definition</b> Error.h:176</div></div>
<div class="ttc" id="aclass_error_service_html_a77cf6af4e077a494655aca530d781185"><div class="ttname"><a href="class_error_service.html#a77cf6af4e077a494655aca530d781185">ErrorService::ErrorService</a></div><div class="ttdeci">ErrorService(uint8_t instance_id)</div><div class="ttdoc">Constructor for ErrorService with default Service ID &quot;m&quot;.</div><div class="ttdef"><b>Definition</b> ErrorService.cpp:26</div></div>
<div class="ttc" id="aclass_service_html"><div class="ttname"><a href="class_service.html">Service</a></div><div class="ttdoc">Service-Template to derive a Service class by defining the Content (derived Class of &quot;Content&quot;) to ha...</div><div class="ttdef"><b>Definition</b> Service.h:115</div></div>
</div><!-- fragment --></li>
</ul>
<ul class="check">
<li class="checked">overwriting and implementing the template's <a href="https://f-l-x-s.github.io/BusBricks/class_service_base.html#a6129f02c6e59212d0b5b6d4d451b30e9"><code>stack_processing</code></a></li>
</ul>
<p>The <code>stack_processing</code> function has to process all payloads from the receive-stack and add the payloads to be send to the send-stack. Check <a href="lib/ErrorService/ErrorService.cpp"><code>ErrorService</code></a> or <a href="lib/MessageService/MessageService.cpp"><code>MessageService</code></a> for example implementations.</p>
<ul class="check">
<li class="checked">adding functions to interact with the service besides imparting/picking-up payloads (e.g. <a href="https://f-l-x-s.github.io/BusBricks/class_message__service.html#aa8d198ccf700400339e3240e1c9c86e4"><code>sendMessage</code></a> of the <a href="lib/MessageService/MessageService.h"><code>MessageService</code></a>) (optional)</li>
</ul>
<h1><a class="anchor" id="autotoc_md20"></a>
Build environments and testing</h1>
<h2><a class="anchor" id="autotoc_md21"></a>
clang-build for local debugging</h2>
<p>The project is implemented to be debugged on the local engineering-device (PC). Therefore <a href="test/manual">testing-functions</a> are defined for the local execution with clang (possible with other compilers, but only tested with clang). <br  />
 Those functions are more thought as a "playground" for setting up scenarios to debug, than for approving complete functionality of the Program.<br  />
 The clang-build is customized in <a href=".vscode/tasks.json">tasks</a>.<br  />
 Because of the usage of Arduino-specific functions not supported by c++ natively, those functions are replaced by using the namespaces in <a href="lib/mockArduino/mockArduino.h">Arduino-Mocking</a> and <a href="lib/mockSoftwareSerial/mockSoftwareSerial.h">Serial-Mocking</a>.</p>
<h2><a class="anchor" id="autotoc_md22"></a>
native environment</h2>
<p>The pio native-environment is setup in <a href="platformio.ini">platformio.ini</a>. All <a href="test/native/">automated tests</a> are executed in this environment.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
uno and nano328p environment</h2>
<p>The environments for the target-architecture are configured in <a href="platformio.ini">platformio.ini</a>.</p>
<h1><a class="anchor" id="autotoc_md24"></a>
License</h1>
<h2><a class="anchor" id="autotoc_md25"></a>
GNU Affero General Public License v3.0</h2>
<p>This project is licensed under the GNU Affero General Public License v3.0. See the <a href="https://github.com/F-L-X-S/BusBricks/blob/5e3d14aac293e28b3e3d8c17ed7d4e8bd7617505/LICENSE">LICENSE</a> file for details.</p>
<p>Copyright (c) 2024 Felix Schuelke </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
