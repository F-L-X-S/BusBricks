\doxysection{Comm\+Interface\+\_\+modbus\+RTU Class Reference}
\hypertarget{class_comm_interface__modbus_r_t_u}{}\label{class_comm_interface__modbus_r_t_u}\index{CommInterface\_modbusRTU@{CommInterface\_modbusRTU}}


The Modbus-\/\+RTU Comm\+Interface-\/class specifies a communication interface with Software\+Serial as interface-\/type and Monitors modbus-\/specific timeouts. Ensures correct data-\/transfer between standardized Frame-\/\+Objects in the Interface-\/\+Stack and Software\+Serial.  




{\ttfamily \#include $<$Comm\+Interface\+\_\+modbus\+RTU.\+h$>$}

Inheritance diagram for Comm\+Interface\+\_\+modbus\+RTU\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_comm_interface__modbus_r_t_u}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_comm_interface__modbus_r_t_u_ac349c7e4dafa46ea96d89ed808a67b07}{Comm\+Interface\+\_\+modbus\+RTU}} (\mbox{\hyperlink{classarduino_mocking_1_1_software_serial}{Software\+Serial}} \texorpdfstring{$\ast$}{*}softwareserial, uint16\+\_\+t baudrate, char device\+Id)
\begin{DoxyCompactList}\small\item\em Construct a new \doxylink{class_comm_interface__modbus_r_t_u}{Comm\+Interface\+\_\+modbus\+RTU} object. \end{DoxyCompactList}\item 
\Hypertarget{class_comm_interface__modbus_r_t_u_ae10bee9bfea696f21ab0732420f65241}\label{class_comm_interface__modbus_r_t_u_ae10bee9bfea696f21ab0732420f65241} 
{\bfseries \texorpdfstring{$\sim$}{\string~}\+Comm\+Interface\+\_\+modbus\+RTU} ()
\begin{DoxyCompactList}\small\item\em Destroy the \doxylink{class_comm_interface__modbus_r_t_u}{Comm\+Interface\+\_\+modbus\+RTU} object. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_comm_interface__modbus_r_t_u_a0e78a2a6e3b5b029609c2b16c21bd85b}{send}} () override
\begin{DoxyCompactList}\small\item\em Override of \doxylink{class_comm_interface}{Comm\+Interface} send-\/function. Send the frame, send\+Buffer is pointing to by writing and flushing Software\+Serial-\/interface. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_comm_interface__modbus_r_t_u_a50b42ad0a40a82ebe5a7749313ca2283}{receive}} () override
\begin{DoxyCompactList}\small\item\em Receives a Modbus RTU frame and writes it to {\ttfamily receive\+Buffer}. \end{DoxyCompactList}\item 
char \mbox{\hyperlink{class_comm_interface__modbus_r_t_u_acced18055fd7b7157e66155b1346d20f}{get\+Device\+Id}} ()
\begin{DoxyCompactList}\small\item\em Get Modbus-\/specific device-\/identifier. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_comm_interface}{Comm\+Interface$<$ Software\+Serial $>$}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_comm_interface_a036d6ee859c4aa352083626e3d852da2}{Comm\+Interface}} (\mbox{\hyperlink{classarduino_mocking_1_1_software_serial}{Software\+Serial}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{class_comm_interface_a500d5da6b485fc7450fbd8c9afd79374}{interface}}, uint32\+\_\+t baudrate)
\begin{DoxyCompactList}\small\item\em Construct a new Comm-\/\+Interface object. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_comm_interface_a21c8ee8eddb3011e89b950f1b5264664}{send\+New\+Frame}} (\mbox{\hyperlink{namespacearduino_mocking_a074bce778184555fd29d1370a36298bf}{String}} \texorpdfstring{$\ast$}{*}send\+Frame)
\begin{DoxyCompactList}\small\item\em Specify the next frame to be sent by the interface, no overwrite, if the send\+Buffer is already pointing to another frame. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_comm_interface_a9a27c7221b188bde1632a7c44f79b493}{finished\+Sending}} ()
\begin{DoxyCompactList}\small\item\em Check, if the \doxylink{class_frame}{Frame} was sent and the \doxylink{class_comm_interface}{Comm\+Interface} is ready to send the next \doxylink{class_frame}{Frame} Interface is ready to send a new frame, if the send\+Buffer is nullpointer. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_comm_interface_a446d6dfeb4dd695c061f1ff1c926fb51}{get\+Received\+Frame}} (\mbox{\hyperlink{namespacearduino_mocking_a074bce778184555fd29d1370a36298bf}{String}} \texorpdfstring{$\ast$}{*}dest\+Frame\+Buffer)
\begin{DoxyCompactList}\small\item\em Define the destination, the next received \doxylink{class_frame}{Frame} should be stored at. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_comm_interface_aea53cf3e71460f3a662c175958acb643}{received\+New\+Frame}} ()
\begin{DoxyCompactList}\small\item\em Check, if a new \doxylink{class_frame}{Frame} was received and stored at the in get\+Received\+Frame specified location the interface is waiting waiting for get\+Received\+Frame-\/call to specify the location, the next received frame should be stored at. \end{DoxyCompactList}\item 
virtual void {\bfseries receive\+Cycle} ()
\begin{DoxyCompactList}\small\item\em Execution of receive-\/cycle, set the receive\+Buffer to nullptr after a new frame was received. \end{DoxyCompactList}\item 
virtual void {\bfseries send\+Cycle} ()
\begin{DoxyCompactList}\small\item\em Execution of send-\/cycle, set the send\+Buffer to nullptr, after the frame, send\+Buffer was pointing at, was send. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_comm_interface_base}{Comm\+Interface\+Base}}}
\begin{DoxyCompactItemize}
\item 
void {\bfseries setup\+\_\+interface} ()
\begin{DoxyCompactList}\small\item\em Setup the Interface has to be called in Setup-\/function. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_comm_interface_base_aec9a9fb6aa77428e8b9a65a33172f6a1}{send\+New\+Frame}} (\mbox{\hyperlink{namespacearduino_mocking_a074bce778184555fd29d1370a36298bf}{String}} \texorpdfstring{$\ast$}{*}send\+Frame)
\begin{DoxyCompactList}\small\item\em Add a new \doxylink{class_frame}{Frame} to the send-\/buffer. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_comm_interface_base_a23e0f975ebf29d40bde25eea58465bfa}{finished\+Sending}} ()
\begin{DoxyCompactList}\small\item\em Check, if the \doxylink{class_frame}{Frame} was sent and the \doxylink{class_comm_interface}{Comm\+Interface} is ready to send the next \doxylink{class_frame}{Frame}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_comm_interface_base_a2d2742daa73bbbf0b8317391c5c85a19}{get\+Received\+Frame}} (\mbox{\hyperlink{namespacearduino_mocking_a074bce778184555fd29d1370a36298bf}{String}} \texorpdfstring{$\ast$}{*}dest\+Frame\+Buffer)
\begin{DoxyCompactList}\small\item\em Define the destination, the next received \doxylink{class_frame}{Frame} should be copied to ba a pointer to an empty String-\/\+Object. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_comm_interface_base_a01c285fd2ea35bf3f081ee531e666def}{received\+New\+Frame}} ()
\begin{DoxyCompactList}\small\item\em Check, if a new \doxylink{class_frame}{Frame} was received. \end{DoxyCompactList}\item 
{\bfseries Comm\+Interface\+Base} ()
\begin{DoxyCompactList}\small\item\em Construct a new Comm Interface Base object. \end{DoxyCompactList}\item 
{\bfseries \texorpdfstring{$\sim$}{\string~}\+Comm\+Interface\+Base} ()
\begin{DoxyCompactList}\small\item\em Destroy the Comm-\/\+Interface Base object. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{class_comm_interface}{Comm\+Interface$<$ Software\+Serial $>$}}}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{class_comm_interface}{Comm\+Interface$<$ Software\+Serial $>$}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classarduino_mocking_1_1_software_serial}{Software\+Serial}} \texorpdfstring{$\ast$}{*} {\bfseries interface}
\begin{DoxyCompactList}\small\item\em pointer to an instance of the native bus-\/interface (setup outside of Bus\+Bricks) \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacearduino_mocking_a074bce778184555fd29d1370a36298bf}{String}} \texorpdfstring{$\ast$}{*} {\bfseries send\+Buffer}
\begin{DoxyCompactList}\small\item\em pointer to the next frame to be send, set to nullptr if \doxylink{class_frame}{Frame} was sent \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacearduino_mocking_a074bce778184555fd29d1370a36298bf}{String}} \texorpdfstring{$\ast$}{*} {\bfseries receive\+Buffer}
\begin{DoxyCompactList}\small\item\em pointer to String-\/object, a received frame should be stored at, set to nullptr if \doxylink{class_frame}{Frame} was copied to destination \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The Modbus-\/\+RTU Comm\+Interface-\/class specifies a communication interface with Software\+Serial as interface-\/type and Monitors modbus-\/specific timeouts. Ensures correct data-\/transfer between standardized Frame-\/\+Objects in the Interface-\/\+Stack and Software\+Serial. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_comm_interface__modbus_r_t_u_ac349c7e4dafa46ea96d89ed808a67b07}\index{CommInterface\_modbusRTU@{CommInterface\_modbusRTU}!CommInterface\_modbusRTU@{CommInterface\_modbusRTU}}
\index{CommInterface\_modbusRTU@{CommInterface\_modbusRTU}!CommInterface\_modbusRTU@{CommInterface\_modbusRTU}}
\doxysubsubsection{\texorpdfstring{CommInterface\_modbusRTU()}{CommInterface\_modbusRTU()}}
{\footnotesize\ttfamily \label{class_comm_interface__modbus_r_t_u_ac349c7e4dafa46ea96d89ed808a67b07} 
Comm\+Interface\+\_\+modbus\+RTU\+::\+Comm\+Interface\+\_\+modbus\+RTU (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classarduino_mocking_1_1_software_serial}{Software\+Serial}} \texorpdfstring{$\ast$}{*}}]{softwareserial}{, }\item[{uint16\+\_\+t}]{baudrate}{, }\item[{char}]{device\+Id}{}\end{DoxyParamCaption})}



Construct a new \doxylink{class_comm_interface__modbus_r_t_u}{Comm\+Interface\+\_\+modbus\+RTU} object. 


\begin{DoxyParams}{Parameters}
{\em softwareserial} & pointer to the Software\+Serial-\/instance, the Comminterface should use ~\newline
 \\
\hline
{\em baudrate} & baudrate in bps to calculate timeouts \\
\hline
{\em device\+Id} & Modbus-\/specific device-\/identifier \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_comm_interface__modbus_r_t_u_acced18055fd7b7157e66155b1346d20f}\index{CommInterface\_modbusRTU@{CommInterface\_modbusRTU}!getDeviceId@{getDeviceId}}
\index{getDeviceId@{getDeviceId}!CommInterface\_modbusRTU@{CommInterface\_modbusRTU}}
\doxysubsubsection{\texorpdfstring{getDeviceId()}{getDeviceId()}}
{\footnotesize\ttfamily \label{class_comm_interface__modbus_r_t_u_acced18055fd7b7157e66155b1346d20f} 
char Comm\+Interface\+\_\+modbus\+RTU\+::get\+Device\+Id (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Get Modbus-\/specific device-\/identifier. 

\begin{DoxyReturn}{Returns}
char Modbus-\/specific device-\/identifier 
\end{DoxyReturn}
\Hypertarget{class_comm_interface__modbus_r_t_u_a50b42ad0a40a82ebe5a7749313ca2283}\index{CommInterface\_modbusRTU@{CommInterface\_modbusRTU}!receive@{receive}}
\index{receive@{receive}!CommInterface\_modbusRTU@{CommInterface\_modbusRTU}}
\doxysubsubsection{\texorpdfstring{receive()}{receive()}}
{\footnotesize\ttfamily \label{class_comm_interface__modbus_r_t_u_a50b42ad0a40a82ebe5a7749313ca2283} 
bool Comm\+Interface\+\_\+modbus\+RTU\+::receive (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Receives a Modbus RTU frame and writes it to {\ttfamily receive\+Buffer}. 

Waits for incoming bytes for a duration defined by {\ttfamily \+\_\+rec\+Timeout}. If no bytes are received within this period, the function exits. When bytes are received via Software\+Serial, the function starts writing the frame to {\ttfamily receive\+Buffer} once a byte containing the device ID of the {\ttfamily \doxylink{class_comm_interface}{Comm\+Interface}} instance is detected. If the device ID is the null terminator (master mode), all incoming frames are captured. Bytes related to the frame must be received within the {\ttfamily \+\_\+char\+Timeout}.

The function continues receiving until either {\ttfamily MAXFRAMESIZE} is reached or {\ttfamily \+\_\+char\+Timeout} expires. After receiving, it waits for {\ttfamily \+\_\+frame\+Timeout} before clearing the Software\+Serial receive buffer by calling {\ttfamily \+\_\+clear\+Rx\+Buffer}.

\begin{DoxyReturn}{Returns}
{\ttfamily true} if a frame was successfully received and written to {\ttfamily receive\+Buffer} within the receive timeout. 

{\ttfamily false} if no frame was received during {\ttfamily \+\_\+rec\+Timeout}.
\end{DoxyReturn}
The function operates in two modes\+:
\begin{DoxyItemize}
\item {\bfseries{Slave Mode}}\+: Begins receiving only if the frame is addressed to the device\textquotesingle{}s ID.
\item {\bfseries{Master Mode}}\+: Captures any incoming frame.
\end{DoxyItemize}

The function does not validate the content of the received frame. It uses timeouts to ensure the entire frame is received and then clears the communication interface\textquotesingle{}s buffer.

\begin{DoxyNote}{Note}
If {\ttfamily DEBUG} is defined, debugging information is printed to the serial monitor. 
\end{DoxyNote}


Implements \mbox{\hyperlink{class_comm_interface_a81c74dee239a10522d30900943f64eb2}{Comm\+Interface$<$ Software\+Serial $>$}}.

\Hypertarget{class_comm_interface__modbus_r_t_u_a0e78a2a6e3b5b029609c2b16c21bd85b}\index{CommInterface\_modbusRTU@{CommInterface\_modbusRTU}!send@{send}}
\index{send@{send}!CommInterface\_modbusRTU@{CommInterface\_modbusRTU}}
\doxysubsubsection{\texorpdfstring{send()}{send()}}
{\footnotesize\ttfamily \label{class_comm_interface__modbus_r_t_u_a0e78a2a6e3b5b029609c2b16c21bd85b} 
bool Comm\+Interface\+\_\+modbus\+RTU\+::send (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Override of \doxylink{class_comm_interface}{Comm\+Interface} send-\/function. Send the frame, send\+Buffer is pointing to by writing and flushing Software\+Serial-\/interface. 

\begin{DoxyReturn}{Returns}
true frame was flushed to serial-\/bus 

false send\+Buffer is nullptr 
\end{DoxyReturn}


Implements \mbox{\hyperlink{class_comm_interface_a458e3da4ff47bdf6cc9f0a5f956c80dd}{Comm\+Interface$<$ Software\+Serial $>$}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
/\+Users/felixschulke/\+Developement/\+Arduino/\+Modbus\+\_\+\+RTU/\+Modbus\+\_\+\+RTU/\+Modbus-\/\+RTU/lib/\+Modbus\+RTU/\mbox{\hyperlink{_comm_interface__modbus_r_t_u_8h}{Comm\+Interface\+\_\+modbus\+RTU.\+h}}\item 
/\+Users/felixschulke/\+Developement/\+Arduino/\+Modbus\+\_\+\+RTU/\+Modbus\+\_\+\+RTU/\+Modbus-\/\+RTU/lib/\+Modbus\+RTU/Comm\+Interface\+\_\+modbus\+RTU.\+cpp\end{DoxyCompactItemize}
