\doxysection{Frame\+\_\+modbus\+RTU.\+h}
\hypertarget{_frame__modbus_r_t_u_8h_source}{}\label{_frame__modbus_r_t_u_8h_source}\index{/Users/felixschulke/Developement/Arduino/Modbus\_RTU/Modbus\_RTU/Modbus-\/RTU/lib/ModbusRTU/Frame\_modbusRTU.h@{/Users/felixschulke/Developement/Arduino/Modbus\_RTU/Modbus\_RTU/Modbus-\/RTU/lib/ModbusRTU/Frame\_modbusRTU.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ FRAME\_MODBUSRTU\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ FRAME\_MODBUSRTU\_H}}
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#ifdef\ ARDUINO}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\ \ \ \ \#include\ <Arduino.h>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\ \ \ \ \#include\ <mockArduino.h>}}
\DoxyCodeLine{00007\ \ \ \ \ \textcolor{keyword}{using\ namespace\ }arduinoMocking;}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include<Frame.h>}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#define\ PREFIXSIZE\ 2\ \ \ \ }\textcolor{comment}{//\ two\ bytes\ Prefix\ (Device-\/adress,\ modbus-\/functioncode)}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ SUFFIXSIZE\ 2\ \ \ \ }\textcolor{comment}{//\ two\ bytes\ Suffix\ (CRC\ HighByte\ /\ LowByte)}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ CRC16MASK\ 0xA001}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#define\ CRC16VALUE\ 0xFFFF}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{comment}{//\ Class\ for\ defining\ the\ structure\ of\ the\ Modbus-\/RTU-\/Frame}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ Constructors:}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ Construction\ by\ PDU:\ }}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ Frame\_modbusRTU(pduString*\ pdu,\ char*\ slaveId,\ char*\ functionCode)}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ Object\ calculates\ and\ adds\ the\ CRC16,\ }}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ the\ Modbus-\/Slave-\/ID\ and\ the\ Modbus-\/Function-\/Code\ and\ adds\ them\ to\ the\ Frame-\/representation.\ }}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ Construction\ by\ Frame-\/representation:}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ Frame\_modbusRTU(frameString*\ frame)}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ Object\ extracts\ Payload,\ Slave-\/ID\ and\ Function-\/Code\ and\ checks\ the\ CRC16\ for\ plausibility\ by\ checking\ rest\ =\ 0.\ }}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ }}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ because\ the\ frame-\/representation\ is\ stored\ as\ a\ reference,\ the\ representation\ has\ to\ be\ allocated\ on\ the\ heap-\/memory\ (buffer)}}
\DoxyCodeLine{00029\ \textcolor{comment}{//\ The\ allocation\ is\ done\ during\ the\ conversion\ from\ "{}Content"{}\ (construction\ by\ PDU)\ within\ the\ content\_to\_rep-\/function}}
\DoxyCodeLine{00030\ \textcolor{comment}{//\ or\ it\ has\ to\ be\ initiated\ by\ calling\ the\ function\ "{}copy\_to\_heap"{}\ (e.g.\ in\ copy-\/constructor\ or\ during\ construction\ by\ frame-\/representation)}}
\DoxyCodeLine{00031\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}:\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_frame}{Frame}}\{}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construct\ Modbus-\/RRU-\/Frame\ from\ given\ PDU\ (Content)}}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}(pduString*\ pdu,\ \textcolor{keywordtype}{char}*\ slaveId,\ \textcolor{keywordtype}{char}*\ functionCode);}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construct\ Modbus-\/RTU-\/Frame\ from\ given\ Byte-\/Frame\ (Representation)}}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}(frameString*\ frame);}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Construct\ empty\ Modbus-\/RTU-\/Frame\ }}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}();}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Deconstructor\ }}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_frame__modbus_r_t_u}{\string~Frame\_modbusRTU}}();}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ constructor}}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}\&\ other);\ }
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Assignment\ operator}}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}\&\ operator=(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_frame__modbus_r_t_u}{Frame\_modbusRTU}}\&\ other);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ the\ CRC16-\/value\ for\ teh\ given\ buffer\ }}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ checkCRC16();}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ Modbus-\/RTU-\/function-\/code\ of\ the\ frame-\/instance\ }}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ getFunctionCode();}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ slaveId\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ functionCode\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}*\ buffer\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[1];}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ the\ given\ Content\ (PDU)\ to\ Representation\ (Frame)}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ content\_to\_rep()\ \ \textcolor{keyword}{override};}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ the\ given\ Representation\ (Frame)\ to\ Content\ (PDU)\ }}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ rep\_to\_content()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ CRC16-\/value\ of\ the\ given\ buffer\ }}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ calcCRC16(\textcolor{keywordtype}{char}*\ buffer,\ uint8\_t\ size);}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ the\ representation\ pointing\ to\ an\ outside\ defined\ char-\/array\ to\ heap-\/memory}}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ has\ to\ be\ called\ to\ ensure,\ that\ destructor\ is\ deleting\ from\ heap\ and\ not\ from\ stack}}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ copy\_to\_heap(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}**\ str\_ptr);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ FRAME\_MODBUSRTU\_H}}

\end{DoxyCode}
